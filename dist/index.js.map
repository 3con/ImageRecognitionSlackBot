{"version":3,"sources":["../index.js"],"names":["config","update","region","rekognition","Rekognition","settings","token","name","bot","params","icon_emoji","channelOrGroup","postOrGroupName","sendMessage","messageText","postMessageToChannel","postMessageToGroup","tellMeWhatThisIs","base64Image","detectLabels","Image","Bytes","err","data","console","log","Labels","Name","on","text","toUpperCase","startsWith","url","substring","length","error","result"],"mappings":";;AAAA;;;;AACA;;;;AACA;;AACA;;;;AAEA,iBAAIA,MAAJ,CAAWC,MAAX,CAAkB,EAACC,QAAQ,WAAT,EAAlB;;AAEA,IAAMC,cAAc,IAAI,iBAAIC,WAAR,EAApB;;AAEA;AACA,IAAMC,WAAW;AACbC,yBADa;AAEbC,UAAM;AAFO,CAAjB;;AAKA,IAAMC,MAAM,wBAAQH,QAAR,CAAZ;;AAEA;AACA,IAAMI,SAAS;AACXC,gBAAY;AADD,CAAf;;AAIA;AACA,IAAMC,iBAAiB,OAAvB;AACA,IAAMC,kBAAkB,kBAAxB;;AAEA;AACA,SAASC,WAAT,CAAqBC,WAArB,EAAkC;AAC9B,QAAIH,mBAAmB,SAAvB,EAAkC;AAC9BH,YAAIO,oBAAJ,CAAyBH,eAAzB,EAA0CE,WAA1C,EAAuDL,MAAvD;AACH,KAFD,MAGK;AACDD,YAAIQ,kBAAJ,CAAuBJ,eAAvB,EAAwCE,WAAxC,EAAqDL,MAArD;AACH;AACJ;;AAED,SAASQ,gBAAT,CAA0BC,WAA1B,EAAuC;AACnCf,gBAAYgB,YAAZ,CAAyB;AACrBC,eAAO;AACHC,mBAAOH;AADJ;AADc,KAAzB,EAIG,UAAUI,GAAV,EAAeC,IAAf,EAAqB;AACpB,YAAID,GAAJ,EACIE,QAAQC,GAAR,CAAYH,GAAZ,EADJ,KAGIT,iCAA+BU,KAAKG,MAAL,CAAY,CAAZ,EAAeC,IAA9C,cAA2DJ,KAAKG,MAAL,CAAY,CAAZ,EAAeC,IAA1E;AACP,KATD;AAUH;;AAEDnB,IAAIoB,EAAJ,CAAO,SAAP,EAAkB,UAAUL,IAAV,EAAgB;AAC9B;AACAC,YAAQC,GAAR,CAAYF,IAAZ;;AAEA;AACA,QAAIA,KAAKM,IAAT,EAAe;AACX;AACA,YAAIN,KAAKM,IAAL,CAAUC,WAAV,GAAwBC,UAAxB,CAAmC,iCAAnC,CAAJ,EAA2E;AACvEP,oBAAQC,GAAR,CAAY,iBAAZ;AACA,gBAAIO,MAAMT,KAAKM,IAAL,CAAUI,SAAV,CAAoB,kCAAkCC,MAAlC,GAA2C,CAA/D,EAAkEX,KAAKM,IAAL,CAAUK,MAAV,GAAmB,CAArF,CAAV;AACAV,oBAAQC,GAAR,CAAYO,GAAZ;AACA,yCAAOA,GAAP,EAAY,EAAZ,EAAgB,UAACG,KAAD,EAAQC,MAAR;AAAA,uBAAmBnB,iBAAiBmB,MAAjB,CAAnB;AAAA,aAAhB;AACH;AACJ;AACJ,CAdD","file":"index.js","sourcesContent":["import AWS from 'aws-sdk';\nimport Bot from \"slackbots\";\nimport {TOKEN} from \"./secrets\";\nimport {encode} from 'node-base64-image';\n\nAWS.config.update({region: 'eu-west-1'});\n\nconst rekognition = new AWS.Rekognition();\n\n// create a bot\nconst settings = {\n    token: TOKEN,\n    name: 'SeeingEyeBot'\n};\n\nconst bot = new Bot(settings);\n\n// give him a face\nconst params = {\n    icon_emoji: ':robot_face:'\n};\n\n// define group or channel that we are posting to\nconst channelOrGroup = 'group';\nconst postOrGroupName = 'jono_button_test';\n\n// function to send a message to either a group (private channel) or a channel\nfunction sendMessage(messageText) {\n    if (channelOrGroup === 'channel') {\n        bot.postMessageToChannel(postOrGroupName, messageText, params);\n    }\n    else {\n        bot.postMessageToGroup(postOrGroupName, messageText, params);\n    }\n}\n\nfunction tellMeWhatThisIs(base64Image) {\n    rekognition.detectLabels({\n        Image: {\n            Bytes: base64Image\n        }\n    }, function (err, data) {\n        if (err)\n            console.log(err);\n        else\n            sendMessage(`That looks like ${data.Labels[0].Name} or a ${data.Labels[1].Name} to me`);\n    });\n}\n\nbot.on('message', function (data) {\n    // all ingoing events https://api.slack.com/rtm\n    console.log(data);\n\n    // check that the message has text\n    if (data.text) {\n        // start a new game\n        if (data.text.toUpperCase().startsWith('@WHAT-IS-THIS-BOT WHAT IS THIS?')) {\n            console.log('we have a match');\n            let url = data.text.substring('@WHAT-IS-THIS-BOT WHAT IS THIS?'.length + 2, data.text.length - 1);\n            console.log(url);\n            encode(url, {}, (error, result) => tellMeWhatThisIs(result));\n        }\n    }\n});"]}